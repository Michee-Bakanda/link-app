{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useContext, useEffect } from \"react\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport { AuthContext } from \"../context/auth\";\nimport FooterTabs from \"../components/nav/FooterTabs\";\nimport { LinkContext } from \"../context/link\";\nimport axios from \"axios\";\nimport PreviewCard from \"../components/links/PreviewCard\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar TrendingLinks = function TrendingLinks(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useContext = useContext(AuthContext),\n      _useContext2 = _slicedToArray(_useContext, 2),\n      state = _useContext2[0],\n      setState = _useContext2[1];\n\n  var _useContext3 = useContext(LinkContext),\n      _useContext4 = _slicedToArray(_useContext3, 2),\n      links = _useContext4[0],\n      setLinks = _useContext4[1];\n\n  useEffect(function () {\n    fetchLinks();\n  }, []);\n\n  var fetchLinks = function fetchLinks() {\n    var _await$axios$get, data;\n\n    return _regeneratorRuntime.async(function fetchLinks$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(axios.get(\"/links\"));\n\n          case 2:\n            _await$axios$get = _context.sent;\n            data = _await$axios$get.data;\n            setLinks(data);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handlePress = function handlePress(link) {\n    return _regeneratorRuntime.async(function handlePress$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(axios.put(\"/view-count/\" + link._id));\n\n          case 2:\n            navigation.navigate(\"LinkView\", {\n              link: link\n            });\n            setLinks(function () {\n              var index = links.findIndex(function (l) {\n                return l._id === link._id;\n              });\n              links[index] = _objectSpread(_objectSpread({}, link), {}, {\n                views: link.views + 1\n              });\n              return _toConsumableArray(links);\n            });\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return _jsxs(ImageBackground, {\n    resizeMode: \"cover\",\n    source: require(\"../assets/trending.jpeg\"),\n    style: {\n      flex: 1,\n      height: \"100%\"\n    },\n    children: [_jsx(Text, {\n      style: {\n        color: \"#fff\",\n        paddingTop: 50,\n        paddingBottom: 20\n      },\n      children: \"Trending Links\"\n    }), _jsx(RenderLinks, {\n      links: links && links.sort(function (a, b) {\n        return a.views < b.views ? 1 : -1;\n      }).slice(0, 3),\n      handlePress: handlePress\n    }), _jsx(Text, {\n      style: {\n        color: \"#fff\",\n        marginTop: -50,\n        paddingBottom: 20\n      },\n      children: \"Latest Links\"\n    }), _jsx(RenderLinks, {\n      links: links && links.sort(function (a, b) {\n        return a.createdAt < b.createdAt ? 1 : -1;\n      }).slice(0, 3),\n      handlePress: handlePress\n    }), _jsx(FooterTabs, {})]\n  });\n};\n\nvar RenderLinks = function RenderLinks(_ref2) {\n  var links = _ref2.links,\n      handlePress = _ref2.handlePress;\n  return _jsx(ScrollView, {\n    horizontal: true,\n    showsHorizontalScrollIndicator: false,\n    children: links.map(function (link) {\n      return _jsx(View, {\n        style: {\n          alignItems: \"center\",\n          width: 400,\n          height: 300\n        },\n        children: _jsx(PreviewCard, _objectSpread(_objectSpread({}, link.urlPreview), {}, {\n          handlePress: handlePress,\n          link: link,\n          showIcons: true\n        }))\n      }, link._id);\n    })\n  });\n};\n\nexport default TrendingLinks;","map":{"version":3,"names":["React","useContext","useEffect","AuthContext","FooterTabs","LinkContext","axios","PreviewCard","TrendingLinks","navigation","state","setState","links","setLinks","fetchLinks","get","data","handlePress","link","put","_id","navigate","index","findIndex","l","views","require","flex","height","color","paddingTop","paddingBottom","sort","a","b","slice","marginTop","createdAt","RenderLinks","map","alignItems","width","urlPreview"],"sources":["/home/michee/Documents/link/105_loading/client/screens/TrendingLinks.js"],"sourcesContent":["import React, { useContext, useEffect } from \"react\";\nimport {\n  SafeAreaView,\n  View,\n  ScrollView,\n  TouchableOpacity,\n  ImageBackground,\n  Text\n} from \"react-native\";\n// import Text from \"//@kaloraat/react-native-text\";\nimport { AuthContext } from \"../context/auth\";\nimport FooterTabs from \"../components/nav/FooterTabs\";\nimport { LinkContext } from \"../context/link\";\nimport axios from \"axios\";\nimport PreviewCard from \"../components/links/PreviewCard\";\n\nconst TrendingLinks = ({ navigation }) => {\n  const [state, setState] = useContext(AuthContext);\n  const [links, setLinks] = useContext(LinkContext);\n\n  useEffect(() => {\n    fetchLinks();\n  }, []);\n\n  const fetchLinks = async () => {\n    const { data } = await axios.get(\"/links\");\n    setLinks(data);\n  };\n\n  const handlePress = async (link) => {\n    await axios.put(`/view-count/${link._id}`);\n    navigation.navigate(\"LinkView\", { link });\n    // update link in the context\n    setLinks(() => {\n      const index = links.findIndex((l) => l._id === link._id);\n      links[index] = { ...link, views: link.views + 1 };\n      return [...links];\n    });\n  };\n\n  return (\n    <ImageBackground\n      resizeMode=\"cover\"\n      source={require(\"../assets/trending.jpeg\")}\n      style={{ flex: 1, height: \"100%\" }}\n    >\n      <Text\n       \n        style={{ color: \"#fff\", paddingTop: 50, paddingBottom: 20 }}\n      >\n        Trending Links\n      </Text>\n\n      <RenderLinks\n        links={\n          links &&\n          links.sort((a, b) => (a.views < b.views ? 1 : -1)).slice(0, 3)\n        }\n        handlePress={handlePress}\n      />\n\n      <Text\n       \n        style={{ color: \"#fff\", marginTop: -50, paddingBottom: 20 }}\n      >\n        Latest Links\n      </Text>\n\n      <RenderLinks\n        links={\n          links &&\n          links.sort((a, b) => (a.createdAt < b.createdAt ? 1 : -1)).slice(0, 3)\n        }\n        handlePress={handlePress}\n      />\n\n      <FooterTabs />\n    </ImageBackground>\n  );\n};\n\nconst RenderLinks = ({ links, handlePress }) => (\n  <ScrollView horizontal showsHorizontalScrollIndicator={false}>\n    {links.map((link) => (\n      <View\n        key={link._id}\n        style={{\n          alignItems: \"center\",\n          width: 400,\n          height: 300,\n        }}\n      >\n        <PreviewCard\n          {...link.urlPreview}\n          handlePress={handlePress}\n          link={link}\n          showIcons={true}\n        />\n      </View>\n    ))}\n  </ScrollView>\n);\n\nexport default TrendingLinks;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}